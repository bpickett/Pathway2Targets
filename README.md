# Pathway2Targets

Pathway2Targets is a systems biology-based algorithm that predicts existing targets and therapeutics that could be repurposed to treat a given disease/indication. Importantly, this algorithm was designed to enable the user to specify the weight that each of 10 target attributes should carry for prioritization. 

## Implementation
The required input for running Pathway2Targets is a list of significant signaling pathways from generated by either enrichr or signaling pathway impact analysis (SPIA) algorithms. The algorithm retrieves the members of each signaling pathway from multiple databases (if SPIA is used), or from Reactome if enrichr is used. The members of each pathway are then programmatically cross-referenced to the OpenTargets.org database to retrieve the relevant information for any known therapeutic target. A flexible and customizable weighting scheme is implemented in the software to enable target prioritization. The attributes used to calculate the weighted score (and their default values) are:
   #### 1) Number of targets in pathway (1)
   #### 2) Tractability, defined as the number of different modalities used to affect the target (1)
   #### 3) Number of approved drugs (1)
   #### 4) Safety Liabilities (-2)
   #### 5) Number of unique therapeutics that affect the target (1)
   #### 6) Number of diseases target is associated with (1)
   #### 7) Number of therapeutics in phase 1 (0.5)
   #### 8) Number of therapeutics in phase 2 (1)
   #### 9) Number of therapeutics in phase 3 (1.5)
   #### 10) Number of therapeutics in phase 4 (2)

The output of Pathway2Targets is two tables that contain 1) a list of targets, prioritized by the weighted score calculated by the 10 criteria; and 2) a list of existing therapeutics in the OpenTargets database that are prioritized by the same 10 criteria.

## Input Requirements
Pathway2Targets requires a comma-separated value (csv) file as input. This file should contain, at a minimum, a list of 1) pathway names from Reactome, 2) their associated p-values.

If the Reactome signaling pathway enrichment was calculated by enrichr, a csv file containing the output table (for Reactome pathways only) should be used as input to this tool. This file is automatically compatible with the software. An example enrichr input file, generated from colorectal cancer data, is provided (Example_enrichr_Input.csv).

If the enrichment was calculated with SPIA, the csv file should be used as the input to the software. An example SPIA input file, generated from colorectal cancer data, is provided (Example_SPIA_Input.csv).

# Running Pathway2Targets
The Pathways2Targets.R script requires the graphite, biomaRt, RCurl, stringr, jsonlite, and httr libraries in R and Bioconductor. The following command should be used to run the script from the command-line:
Rscript --vanilla Pathway2Target.R <path_to_significant_pathway_file>

Before running this software, the pathway information from the Reactome database should be stored locally through the R graphite library. To do so, load the graphite library in R and use the following command for Reactome:
prepareSPIA(humanReactome, "Reactome", print.names=TRUE)

Similar local files should be generated for the KEGG, BioCarta, NCI, and Panther signaling pathway databases. Please recognize that only significant Reactome data can be analyzed if using enrichr, while data from all 5 databases can be analyzed when using the SPIA output.

## Upstream Analyses (for calculating differential expression & Signaling Pathways)
For convenience, descriptions of the software we used to calculate the differential expression and significant pathways are below.
### ARMOR
Instructions on downloading and installing ARMOR can be found here: https://github.com/csoneson/ARMOR.

### Converting Ensembl IDs to Entrez IDs
After successfully completing a run with ARMOR, the edgeR output file should be used as input to the Get_entrezID_from_ENSG.R. This script retrieves the relevant NCBI Entrez Gene IDs for the Ensembl Gene IDs output by ARMOR. 

### Running SPIA
The output of the Get_entrezID_from_ENSG.R script can then be used as input for the Signaling Pathway Impact Analysis (SPIA) algorithm using the SPIA_Code.Rmd script.
